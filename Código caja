<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caja Saborearte: Recomendaci√≥n</title>
    <style>
        /* Estilos Generales y Fondo */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f7f6;
            color: #333;
            /* Fondo de Colores C√°lidos Abstractos con Flores Blancas */
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(255, 204, 153, 0.4) 0%, rgba(255, 178, 102, 0.4) 100%),
                url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text x="10" y="20" font-size="20" opacity="0.1" fill="white">üå∏</text><text x="60" y="80" font-size="25" opacity="0.1" fill="white">üåº</text><text x="30" y="50" font-size="15" opacity="0.15" fill="white">üåø</text></svg>');
            background-size: cover;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .container {
            max-width: 600px;
            width: 90%;
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(5px);
        }
        h1 {
            color: #A0522D;
            text-align: center;
            margin-bottom: 20px;
        }
        h3 {
            color: #D2691E;
            margin-top: 0;
        }
        .step {
            display: none;
        }
        .step.active {
            display: block;
        }
        .option-group label {
            display: block;
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #FFDAB9;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .option-group label:hover {
            background-color: #FFF0F5;
        }
        input[type="radio"] {
            margin-right: 10px;
            accent-color: #D2691E;
        }
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }
        button {
            background-color: #D2691E;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            flex: 1;
            margin: 0 5px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #A0522D;
        }
        #btnAnterior {
            background-color: #ccc;
        }
        #btnAnterior:hover {
            background-color: #999;
        }
        /* Resultados */
        #resultados {
            margin-top: 20px;
            padding: 20px;
            border: 2px solid #D2691E;
            border-radius: 10px;
            background-color: #fffaf0;
        }
        .result-item {
            font-size: 1.1em;
            margin-bottom: 8px;
            padding-left: 15px;
            position: relative;
        }
        .alergia-nota {
            color: red;
            font-weight: bold;
            margin-top: 15px;
        }

        /* Interfaz de Reemplazo (Final) */
        .producto-opciones {
            border: 1px solid #D2691E;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
        }
        .producto-opciones select {
            width: 100%;
            padding: 8px;
            margin-top: 8px;
            border-radius: 4px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>üì¶ Caja Saborearte</h1>
    <p>Responde 5 preguntas para crear tu caja personalizada.</p>
    
    <form id="saborearteForm">
        <div class="step active" id="step1">
            <h3>üñºÔ∏è 1. Gustos Est√©ticos Generales</h3>
            <p>Esto influir√° en la **obra art√≠stica** que incluye la caja.</p>
            <div class="option-group">
                <label><input type="radio" name="estetica" value="Barroco" required>Barroco (Dram√°tico, Fuerte Contraste)</label>
                <label><input type="radio" name="estetica" value="Renacentista">Renacentista (Cl√°sico, Arm√≥nico, Proporci√≥n)</label>
                <label><input type="radio" name="estetica" value="Impresionista">Impresionista (Luz, Color, Pinceladas Sueltas)</label>
                <label><input type="radio" name="estetica" value="Abstracto">Abstracto (Forma, Color y L√≠nea sin representaci√≥n objetiva)</label>
                <label><input type="radio" name="estetica" value="Pop Art">Pop Art (Cultura Popular, Colores S√≥lidos y Vivos)</label>
            </div>
        </div>

        <div class="step" id="step2">
            <h3>üç´ 2. Gustos en Comida Dulce</h3>
            <p>¬øQu√© sabor dulce prefieres en tu reposter√≠a?</p>
            <div class="option-group">
                <label><input type="radio" name="dulce" value="Chocolate Negro" required>Chocolate Negro (Intenso)</label>
                <label><input type="radio" name="dulce" value="Arequipe">Arequipe / Cajeta (Dulce de Leche)</label>
                <label><input type="radio" name="dulce" value="Frutas y C√≠tricos">Frutas y C√≠tricos (Fresco)</label>
                <label><input type="radio" name="dulce" value="Caramelo y Vainilla">Caramelo y Vainilla (Cremoso)</label>
                <label><input type="radio" name="dulce" value="Especiado">Especiado (Canela, Jengibre)</label>
            </div>
        </div>

        <div class="step" id="step3">
            <h3>üòå 3. Estado de √Ånimo</h3>
            <p>¬øQu√© ambiente o sensaci√≥n buscas evocar?</p>
            <div class="option-group">
                <label><input type="radio" name="animo" value="Relajado" required>Relajado/Tranquilo</label>
                <label><input type="radio" name="animo" value="Alegre">Alegre/En√©rgico</label>
                <label><input type="radio" name="animo" value="Reflexivo">Reflexivo/Concentrado</label>
                <label><input type="radio" name="animo" value="Rom√°ntico">Rom√°ntico/Afectivo</label>
            </div>
        </div>
        
        <div class="step" id="step4">
            <h3>‚òï 4. Tipo de Caf√©/Bebidas</h3>
            <p>Elige el perfil de sabor de tu bebida principal.</p>
            <div class="option-group">
                <label><input type="radio" name="cafe" value="C√≠tricas y Florales" required>C√≠tricas y Florales (Tostado Ligero)</label>
                <label><input type="radio" name="cafe" value="Chocolate y Nuez">Chocolate y Nuez (Tostado Medio, Cl√°sico)</label>
                <label><input type="radio" name="cafe" value="Terrosas y Especiadas">Terrosas y Especiadas (Tostado Oscuro, Intenso)</label>
                <label><input type="radio" name="cafe" value="Sin Caf√©">Sin Caf√© (Infusiones/T√©s)</label>
            </div>
        </div>

        <div class="step" id="step5">
            <h3>‚ö†Ô∏è 5. Alergias y Restricciones</h3>
            <p>Menciona cualquier alergia (ej: nueces, gluten).</p>
            <input type="text" id="alergias" name="alergias" placeholder="Ej: Nueces, Gluten" style="width: 98%; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
        </div>

        <div class="navigation-buttons">
            <button type="button" id="btnAnterior" onclick="cambiarPaso(-1)" style="display: none;">‚Üê Anterior</button>
            <button type="button" id="btnSiguiente" onclick="cambiarPaso(1)">Siguiente ‚Üí</button>
            <button type="submit" id="btnFinalizar" style="display: none;">‚ú® Generar Recomendaci√≥n</button>
        </div>
    </form>

    <div id="resultados" style="display:none;">
        <h2>‚úÖ Recomendaci√≥n de tu Caja SaboreArte</h2>
        <p>Se recomienda una caja SaboreArte que incluya los siguientes elementos:</p>
        
        <div id="listaRecomendada">
            </div>

        <p class="alergia-nota" id="alergiaNota" style="display:none;">
            ‚ö†Ô∏è **NOTA IMPORTANTE:** Se debe verificar que todos los productos sean libres de [ALERGIAS].
        </p>
        
        <hr>

        <div id="interfazReemplazo">
            <h3>üõ†Ô∏è Ajusta tu Caja (Opcional)</h3>
            <p>Usa las opciones para cambiar cualquiera de los 3 productos principales.</p>
            
            <div id="opcionesFinales">
                </div>

            <button onclick="confirmarCompra()">üõí Confirmar y A√±adir al Carrito</button>
        </div>

        <p id="mensajeConfirmacion" style="margin-top: 15px; font-weight: bold; text-align: center; color: green;"></p>
    </div>

</div>

<script>
    let pasoActual = 1;
    const totalPasos = 5;
    let productosRecomendados = {}; // Almacena las recomendaciones originales

    // Opciones para el reemplazo final
    const OBRAS = {
        "Barroco": "Pintura Barroca de Flores (Artista: R. Ruysch)",
        "Renacentista": "Dibujo Renacentista Cl√°sico (Artista: L. da Vinci)",
        "Impresionista": "Pintura Impresionista de Paisaje (Estilo: Monet)",
        "Abstracto": "Obra Abstracta Geom√©trica (Estilo: Mondrian)",
        "Pop Art": "Serigraf√≠a Pop Art de Objeto Com√∫n (Estilo: Warhol)"
    };
    const REPOSTERIA = {
        "Chocolate Negro": "Trufas de Chocolate Negro (70%+)",
        "Arequipe": "Brownie de Arequipe (Dulce de Leche)",
        "Frutas y C√≠tricos": "Galletas de Mantequilla con Glaseado de Lim√≥n",
        "Caramelo y Vainilla": "Fudge de Caramelo Salado",
        "Especiado": "Mini Pan de Especias con Canela"
    };
    const BEBIDAS = {
        "C√≠tricas y Florales": "Caf√© de Especialidad, tostado ligero, notas c√≠tricas",
        "Chocolate y Nuez": "Caf√© de Especialidad, tostado medio, notas chocolate/nuez",
        "Terrosas y Especiadas": "Caf√© de Especialidad, tostado oscuro, notas especiadas",
        "Sin Caf√©": "T√© Frutal sabor Kiwi (o Mango/Maracuy√°)" // Ejemplo de T√© Frutal espec√≠fico
    };

    // Inicializar botones y pasos
    document.addEventListener('DOMContentLoaded', () => {
        actualizarInterfaz();
    });

    function cambiarPaso(direccion) {
        const pasoActualElement = document.getElementById(`step${pasoActual}`);
        const inputs = pasoActualElement.querySelectorAll('input[type="radio"]');
        let radioChecked = false;

        // Validaci√≥n: Asegurar que se seleccione una opci√≥n antes de avanzar (excepto en Alergias)
        if (direccion > 0 && pasoActual < totalPasos) {
            if (pasoActual !== totalPasos && inputs.length > 0) {
                inputs.forEach(input => { if (input.checked) radioChecked = true; });
                if (!radioChecked) {
                    alert('Por favor, selecciona una opci√≥n para continuar.');
                    return; 
                }
            }
        }
        
        pasoActualElement.classList.remove('active');
        pasoActual += direccion;
        
        if (pasoActual < 1) pasoActual = 1;
        if (pasoActual > totalPasos) pasoActual = totalPasos;

        document.getElementById(`step${pasoActual}`).classList.add('active');
        actualizarInterfaz();
    }

    function actualizarInterfaz() {
        const btnAnterior = document.getElementById('btnAnterior');
        const btnSiguiente = document.getElementById('btnSiguiente');
        const btnFinalizar = document.getElementById('btnFinalizar');

        btnAnterior.style.display = pasoActual > 1 ? 'block' : 'none';
        
        if (pasoActual === totalPasos) {
            btnSiguiente.style.display = 'none';
            btnFinalizar.style.display = 'block';
        } else {
            btnSiguiente.style.display = 'block';
            btnFinalizar.style.display = 'none';
        }
    }

    document.getElementById('saborearteForm').addEventListener('submit', function(event) {
        event.preventDefault();
        generarRecomendacion();
    });

    // L√≥gica de Recomendaci√≥n
    function generarRecomendacion() {
        // 1. Obtener valores
        const estetica = document.querySelector('input[name="estetica"]:checked').value;
        const dulce = document.querySelector('input[name="dulce"]:checked').value;
        const cafe = document.querySelector('input[name="cafe"]:checked').value;
        const alergias = document.getElementById('alergias').value.trim();

        // 2. Mapeo a los 3 productos principales
        const obra = OBRAS[estetica];
        const reposteria = REPOSTERIA[dulce];
        
        let bebida = BEBIDAS[cafe];
        if (cafe === "Sin Caf√©") {
            bebida = "T√© Frutal con sabor a Kiwi"; // Especificaci√≥n solicitada
        }

        // Almacenar recomendaciones originales (con las claves usadas para reemplazo)
        productosRecomendados = {
            obra: { actual: obra, key: estetica },
            reposteria: { actual: reposteria, key: dulce },
            bebida: { actual: bebida, key: cafe }
        };

        // 3. Mostrar Resultados
        let htmlRecomendacion = `
            <div class="result-item">üñºÔ∏è **Obra de Arte:** ${obra}</div>
            <div class="result-item">üç™ **Reposter√≠a:** ${reposteria}</div>
            <div class="result-item">‚òï **Bebida de Autor:** ${bebida}</div>
        `;
        document.getElementById('listaRecomendada').innerHTML = htmlRecomendacion;

        // Mostrar Alergias
        const alergiaNota = document.getElementById('alergiaNota');
        if (alergias) {
            alergiaNota.innerHTML = `‚ö†Ô∏è **NOTA IMPORTANTE:** Se debe verificar que todos los productos sean libres de: **${alergias.toUpperCase()}**.`;
            alergiaNota.style.display = 'block';
        } else {
            alergiaNota.style.display = 'none';
        }

        // Mostrar secci√≥n de resultados, ocultar formulario e inyectar interfaz de reemplazo
        document.getElementById('saborearteForm').style.display = 'none';
        document.getElementById('resultados').style.display = 'block';
        
        inyectarOpcionesReemplazo();
        document.getElementById('resultados').scrollIntoView({ behavior: 'smooth' });
    }
    
    // Funci√≥n para generar la interfaz de reemplazo (Check/Alternativas)
    function inyectarOpcionesReemplazo() {
        const contenedor = document.getElementById('opcionesFinales');
        contenedor.innerHTML = '';
        
        const categorias = [
            { id: 'obra', titulo: 'Obra de Arte', opciones: OBRAS },
            { id: 'reposteria', titulo: 'Reposter√≠a', opciones: REPOSTERIA },
            { id: 'bebida', titulo: 'Bebida de Autor', opciones: BEBIDAS }
        ];

        categorias.forEach(cat => {
            let selectOptions = '';
            // Generar opciones para el selector
            for (const key in cat.opciones) {
                const nombreProducto = cat.opciones[key];
                const selected = (nombreProducto === productosRecomendados[cat.id].actual) ? 'selected' : '';
                selectOptions += `<option value="${nombreProducto}" ${selected}>${nombreProducto}</option>`;
            }

            // Si es la bebida y es "Sin Caf√©", asegurarse de que est√© la opci√≥n correcta
            if (cat.id === 'bebida' && productosRecomendados.bebida.key === 'Sin Caf√©') {
                const nombreProducto = "T√© Frutal con sabor a Kiwi";
                selectOptions = `<option value="${nombreProducto}" selected>${nombreProducto}</option>` + selectOptions;
            }


            const html = `
                <div class="producto-opciones">
                    <label>
                        <input type="checkbox" checked onchange="toggleProducto('${cat.id}')" id="check-${cat.id}">
                        **${cat.titulo}** (Actualmente: ${productosRecomendados[cat.id].actual})
                    </label>
                    <select id="select-${cat.id}" onchange="actualizarCaja()">
                        ${selectOptions}
                    </select>
                </div>
            `;
            contenedor.innerHTML += html;
        });
        
        // Agregar listener de cambio al contenedor para refrescar la lista
        contenedor.addEventListener('change', actualizarCaja);
    }
    
    // Quitar/Poner el producto de la lista (simula "check o se quita")
    function toggleProducto(id) {
        const select = document.getElementById(`select-${id}`);
        const checked = document.getElementById(`check-${id}`).checked;
        select.disabled = !checked;
        actualizarCaja();
    }

    // Funci√≥n para actualizar la lista de productos mostrada al hacer cambios en el selector
    function actualizarCaja() {
        let listaFinal = [];
        
        // Obra
        if (document.getElementById('check-obra').checked) {
            listaFinal.push(`üñºÔ∏è **Obra de Arte:** ${document.getElementById('select-obra').value}`);
        }
        
        // Reposter√≠a
        if (document.getElementById('check-reposteria').checked) {
            listaFinal.push(`üç™ **Reposter√≠a:** ${document.getElementById('select-reposteria').value}`);
        }

        // Bebida
        if (document.getElementById('check-bebida').checked) {
            listaFinal.push(`‚òï **Bebida de Autor:** ${document.getElementById('select-bebida').value}`);
        }
        
        document.getElementById('listaRecomendada').innerHTML = listaFinal.map(item => `<div class="result-item">${item}</div>`).join('');
    }

    function confirmarCompra() {
        const listaConfirmada = document.getElementById('listaRecomendada').innerText;
        document.getElementById('mensajeConfirmacion').innerHTML = "¬°Caja confirmada con √©xito! Contenido final a√±adido al carrito.";
        console.log("Contenido Final Confirmado:", listaConfirmada);
    }
</script>
</body>
</html>
